import{a,O as v,j as e}from"./QueryClientProvider-8Ly9q1Dj.js";import{d as E,f as S,a as k,b as m,e as n,L as C,O as F,c as l}from"./App-VPmrma5G.js";import"./index-5BxWyWw0.js";const q=async t=>(await l.get(`/v1/admin/${t}/get-tables`)).data;function A(){const{venueId:t}=E(),[r,i]=a.useState(""),[o,d]=a.useState(""),[b,c]=a.useState(!1),u=v(),{data:x,isLoading:h,isError:p,error:f}=S({queryKey:["tables_list",t],queryFn:()=>q(t)}),{isAdmin:j}=k(),N=m({mutationFn:s=>l.post("/v1/admin/create-table",{tableNumber:s,venueId:t,headers:{},withCredentials:!0}),onSuccess:()=>{d("Table added"),u.invalidateQueries({queryKey:["tables_list",t]})},onError:s=>{console.log(s),i(s.response.data.error)}}),g=m({mutationFn:s=>l.delete(`/v1/admin/${t}/delete-table`,{headers:{},data:{tableNumber:s},withCredentials:!0}),onSuccess:()=>{d("table deleted"),u.invalidateQueries({queryKey:["tables_list",t]})},onError:s=>{console.log(s),i(s.response.data.error)}});if(!j)return e.jsx("div",{children:"Not authorized"});if(h)return e.jsx("div",{children:"Loading..."});if(p)return e.jsxs("div",{children:["Error: ",f.message]});const w=s=>{s.preventDefault();const y=new FormData(s.target).get("tableNumber");N.mutate(y)};return e.jsxs("div",{className:"py-2 bg-blue-200",children:[e.jsxs("div",{className:"flex flex-col flex-wrap ",children:[e.jsxs("form",{onSubmit:w,className:"mx-auto ",children:[e.jsx("input",{type:"number",name:"tableNumber",className:"border-2 rounded-full"}),e.jsx("button",{className:"w-20 px-2 py-1 border rounded-full",children:"Add"}),r&&e.jsx("p",{className:"text-texts-error",children:r}),o&&e.jsx("p",{children:o})]}),e.jsx("div",{className:"divide-y-2",children:x.map(s=>e.jsxs(n,{dir:"row",space:"sm",children:[e.jsx(C,{to:`${s.tableNumber}`,className:"w-full text-white bg-black",children:s.tableNumber}),e.jsx("div",{children:b?e.jsxs(e.Fragment,{children:[e.jsx(n,{dir:"col",children:e.jsx("span",{className:"text-xs",children:"Erase?"})}),e.jsxs(n,{dir:"row",space:"sm",children:[e.jsx("button",{onClick:()=>g.mutate(s.tableNumber),children:e.jsx("span",{className:"px-2 text-xs text-white border rounded-full bg-background-warning",children:"Yes"})}),e.jsx("button",{onClick:()=>c(!1),children:e.jsx("span",{className:"px-2 text-xs border rounded-full",children:"No"})})]})]}):e.jsx("button",{className:"w-6 h-6 text-white border rounded-full bg-background-warning",onClick:()=>c(!0),children:"X"})})]},s.tableNumber))})]}),e.jsx(F,{})]})}export{A as default};
